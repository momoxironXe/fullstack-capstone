{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import'./Profile.css';import{urlConfig}from'../../config';import{useAppContext}from'../../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Profile=()=>{const[userDetails,setUserDetails]=useState({});const[updatedDetails,setUpdatedDetails]=useState({});const{setUserName}=useAppContext();const[changed,setChanged]=useState(\"\");const[editMode,setEditMode]=useState(false);const navigate=useNavigate();useEffect(()=>{const authtoken=sessionStorage.getItem(\"auth-token\");if(!authtoken){navigate(\"/app/login\");}else{fetchUserProfile();}},[navigate]);const fetchUserProfile=async()=>{try{const authtoken=sessionStorage.getItem(\"auth-token\");const email=sessionStorage.getItem(\"email\");const name=sessionStorage.getItem('name');if(name||authtoken){const storedUserDetails={name:name,email:email};setUserDetails(storedUserDetails);setUpdatedDetails(storedUserDetails);}}catch(error){console.error(error);// Handle error case\n}};const handleEdit=()=>{setEditMode(true);};const handleInputChange=e=>{setUpdatedDetails({...updatedDetails,[e.target.name]:e.target.value});};const handleSubmit=async e=>{e.preventDefault();try{const authtoken=sessionStorage.getItem(\"auth-token\");const email=sessionStorage.getItem(\"email\");if(!authtoken||!email){navigate(\"/app/login\");return;}const payload={...updatedDetails};const response=await fetch(`${urlConfig.backendUrl}/api/auth/update`,{//Step 1: Task 1\nmethod:'PUT',//Step 1: Task 2\nheaders:{\"Authorization\":`Bearer ${authtoken}`,\"Content-Type\":\"application/json\",\"Email\":email},//Step 1: Task 3\nbody:JSON.stringify(payload)});if(response.ok){// Update the user details in session storage\n//Step 1: Task 4\nsetUserName(updatedDetails.name);//Step 1: Task 5\nsessionStorage.setItem(\"name\",updatedDetails.name);setUserDetails(updatedDetails);setEditMode(false);// Display success message to the user\nsetChanged(\"Name Changed Successfully!\");setTimeout(()=>{setChanged(\"\");navigate(\"/\");},1000);}else{// Handle error case\nthrow new Error(\"Failed to update profile\");}}catch(error){console.error(error);// Handle error case\n}};return/*#__PURE__*/_jsx(\"div\",{className:\"profile-container\",children:editMode?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Email\",/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:userDetails.email,disabled:true// Disable the email field\n})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Name\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:updatedDetails.name,onChange:handleInputChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Save\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"profile-details\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Hi, \",userDetails.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\" \",/*#__PURE__*/_jsx(\"b\",{children:\"Email:\"}),\" \",userDetails.email]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleEdit,children:\"Edit\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:'green',height:'.5cm',display:'block',fontStyle:'italic',fontSize:'12px'},children:changed})]})});};export default Profile;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","urlConfig","useAppContext","jsx","_jsx","jsxs","_jsxs","Profile","userDetails","setUserDetails","updatedDetails","setUpdatedDetails","setUserName","changed","setChanged","editMode","setEditMode","navigate","authtoken","sessionStorage","getItem","fetchUserProfile","email","name","storedUserDetails","error","console","handleEdit","handleInputChange","e","target","value","handleSubmit","preventDefault","payload","response","fetch","backendUrl","method","headers","body","JSON","stringify","ok","setItem","setTimeout","Error","className","children","onSubmit","type","disabled","onChange","onClick","style","color","height","display","fontStyle","fontSize"],"sources":["/home/project/fullstack-capstone/giftlink-frontend/src/components/Profile/Profile.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport './Profile.css'\nimport { urlConfig } from '../../config';\nimport { useAppContext } from '../../context/AuthContext';\n\nconst Profile = () => {\n    const [userDetails, setUserDetails] = useState({});\n    const [updatedDetails, setUpdatedDetails] = useState({});\n    const { setUserName } = useAppContext();\n    const [changed, setChanged] = useState(\"\");\n\n    const [editMode, setEditMode] = useState(false);\n    const navigate = useNavigate();\n    useEffect(() => {\n        const authtoken = sessionStorage.getItem(\"auth-token\");\n        if (!authtoken) {\n            navigate(\"/app/login\");\n        } else {\n            fetchUserProfile();\n        }\n    }, [navigate]);\n\n    const fetchUserProfile = async () => {\n        try {\n            const authtoken = sessionStorage.getItem(\"auth-token\");\n            const email = sessionStorage.getItem(\"email\");\n            const name = sessionStorage.getItem('name');\n            if (name || authtoken) {\n                const storedUserDetails = {\n                    name: name,\n                    email: email\n                };\n\n                setUserDetails(storedUserDetails);\n                setUpdatedDetails(storedUserDetails);\n            }\n        } catch (error) {\n            console.error(error);\n            // Handle error case\n        }\n    };\n\n    const handleEdit = () => {\n        setEditMode(true);\n    };\n\n    const handleInputChange = (e) => {\n        setUpdatedDetails({\n            ...updatedDetails,\n            [e.target.name]: e.target.value,\n        });\n    };\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n\n        try {\n            const authtoken = sessionStorage.getItem(\"auth-token\");\n            const email = sessionStorage.getItem(\"email\");\n\n            if (!authtoken || !email) {\n                navigate(\"/app/login\");\n                return;\n            }\n\n            const payload = { ...updatedDetails };\n            const response = await fetch(`${urlConfig.backendUrl}/api/auth/update`, {\n                //Step 1: Task 1\n                method: 'PUT',\n                //Step 1: Task 2\n                headers: {\n                    \"Authorization\": `Bearer ${authtoken}`,\n                    \"Content-Type\": \"application/json\",\n                    \"Email\": email,\n                },\n                //Step 1: Task 3\n                body: JSON.stringify(payload),\n            });\n\n            if (response.ok) {\n                // Update the user details in session storage\n                //Step 1: Task 4\n                setUserName(updatedDetails.name);\n                //Step 1: Task 5\n                sessionStorage.setItem(\"name\", updatedDetails.name);\n                setUserDetails(updatedDetails);\n                setEditMode(false);\n                // Display success message to the user\n                setChanged(\"Name Changed Successfully!\");\n                setTimeout(() => {\n                    setChanged(\"\");\n                    navigate(\"/\");\n                }, 1000);\n\n            } else {\n                // Handle error case\n                throw new Error(\"Failed to update profile\");\n            }\n        } catch (error) {\n            console.error(error);\n            // Handle error case\n        }\n    };\n\n    return (\n        <div className=\"profile-container\">\n            {editMode ? (\n                <form onSubmit={handleSubmit}>\n                    <label>\n                        Email\n                        <input\n                            type=\"email\"\n                            name=\"email\"\n                            value={userDetails.email}\n                            disabled // Disable the email field\n                        />\n                    </label>\n                    <label>\n                        Name\n                        <input\n                            type=\"text\"\n                            name=\"name\"\n                            value={updatedDetails.name}\n                            onChange={handleInputChange}\n                        />\n                    </label>\n\n                    <button type=\"submit\">Save</button>\n                </form>\n            ) : (\n                <div className=\"profile-details\">\n                    <h1>Hi, {userDetails.name}</h1>\n                    <p> <b>Email:</b> {userDetails.email}</p>\n                    <button onClick={handleEdit}>Edit</button>\n                    <span style={{ color: 'green', height: '.5cm', display: 'block', fontStyle: 'italic', fontSize: '12px' }}>{changed}</span>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default Profile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}